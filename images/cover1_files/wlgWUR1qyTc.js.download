if (self.CavalryLogger) { CavalryLogger.start_js(["oZ1JR"]); }

__d("MWMSDeliveryTimestamp.bs",["bs_belt_Option","CurrentUser","bs_belt_MapString","MWChatThreadId.bs","MessengerState.bs"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return b("bs_belt_Option").getWithDefault(b("bs_belt_MapString").get(c,b("MWChatThreadId.bs").getMercuryID(a)),0)}function a(a){var c=b("MessengerState.bs").useHook(b("CurrentUser").getID());c=c.deliveryReceipts;return g(a,c)}f.get=g;f.useHook=a}),null);
__d("MWChatXmaMessage.bs",["ix","fbt","URI","bs_block","MWXMA.bs","bs_string","gkx","bs_belt_Array","bs_caml_array","fbicon","bs_belt_Option","bs_caml_option","CurrentUser","MWChatMessageId.bs","recoverableViolation","XCometInstantGamesHubPlayControllerRouteBuilder"],(function(a,b,c,d,e,f,g,h){"use strict";var i;function j(a){if(b("gkx")("1251877")){a=a.subattachments;if(a==null||a.length===0)return 28;else{a=a[0].style_list;if(a==null||a.length===0)return 28;else{a=a[0];switch(a){case"video":case"video_autoplay":case"video_inline":return 0;default:return 28}}}}else return 28}function a(a){var c=a.style_list;if(c==null||c.length===0)return;else{var d=0;while(!0){var e=d,f=b("bs_caml_array").caml_array_get(c,e);switch(f){case"airline_boarding_pass":if(b("gkx")("1086307"))return 19;else return 27;case"airline_checkin_reminder":if(b("gkx")("1086307"))return 18;else return 27;case"airline_itinerary":if(b("gkx")("1086307"))return 22;else return 27;case"airline_update":if(b("gkx")("1086307"))return 17;else return 27;case"attached_story":return j(a);case"business_message_items":return 2;case"fbpay_offer":return 23;case"instant_games_custom_update":return 6;case"mentorship_curriculum_step":return 24;case"mentorship_xma":return 25;case"message_live_location":if(b("gkx")("1539348"))return 26;else return 27;case"messenger_platform_media_attachment":return 7;case"orion":return 21;case"orion_request":return 20;case"pages_platform_booking_message":return 5;case"messenger_platform_button_list":case"messenger_platform_compact_item":case"messenger_platform_cover_item":case"retail_item":return 3;case"retail_receipt":return 4;case"rooms_speakeasy_xma":return 16;case"share":return 28;case"h_scroll":case"vertical_attachment_list":return 1;default:if((e+1|0)<c.length){d=e+1|0;continue}else return 27}}}}function k(a){if(a>=5)switch(a){case 28:return 1;case 29:return 4;case 30:return 6;case 31:return 5;default:return 6}else if(a>0)switch(a-1|0){case 0:return 0;case 1:return 1;case 2:return 6;case 3:return 2}else return 6}function l(a){a=new(i||(i=b("URI")))(a).getQueryData();var c=a.game_id,d=a.payload,e=a.context_id,f=a.context_type;a=a.source;return b("XCometInstantGamesHubPlayControllerRouteBuilder").buildURL({context_source_id:e,context_type:f,gameorlink:c,payload:d,source:a})}function m(a,c){var d=c.title,e={pageId:c.page_id,ctaId:c.id},f=c.action_link;f=f==null?void 0:b("bs_caml_option").some(f);var g=k(c.action_type),h=0;switch(g){case 1:return b("bs_belt_Option").map(f,function(a){return b("bs_block").__(0,[a,819537557,e])});case 2:return b("bs_block").__(2,[d,{cta_id:c.id,prev_message_id:void 0,ref:void 0,force_handle:!0,postback_cta_ref_source:void 0},e]);case 4:var j=c.cta_data;if(j==null)return;else return b("bs_block").__(4,[b("bs_block").__(2,[{firstScreen:j.feedback_form_first_screen,state:j.feedback_form_state,privacy:j.feedback_form_privacy_policy,formId:j.feedback_form_id}]),e]);case 5:return b("bs_belt_Option").map(f,function(a){a=new(i||(i=b("URI")))(a).getQueryData();var c=a.page_id;a=a.guest_id;return b("bs_block").__(4,[b("bs_block").__(6,[{pageId:c,guestId:a}]),void 0])});case 0:case 3:case 6:h=2;break}h===2&&a!==void 0&&a!==6;if(b("bs_belt_Option").mapWithDefault(f,!1,function(a){return a.startsWith("fb-messenger://instant_games")}))return b("bs_belt_Option").map(f,function(a){return b("bs_block").__(0,[l(a),-10377365,e])});else if(a!==void 0&&!(!(a===3||a===2)||g!==0))return b("bs_belt_Option").map(f,function(a){return b("bs_block").__(4,[b("bs_block").__(9,[{actionLink:a,pageID:c.page_id,userID:b("bs_caml_option").some(b("CurrentUser").getID()),sourceTitle:d}]),e])});else return}function n(a){var c=b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(a.offeritem_title),""),d=b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(a.offeritem_description),"");return{preview:void 0,title:c,description:d,icon:void 0,action:b("bs_block").__(1,[[{title:h._("See Offer Details"),action:b("bs_block").__(4,[b("bs_block").__(0,[{offerId:a.id,title:c}]),void 0])}]]),canForward:!1,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function o(a,c){var d=c.metalines;d=d==null?void 0:b("bs_caml_option").nullable_to_opt(d.metaline_1);var e=c.default_action,f=c.call_to_actions,g,h=0;e==null?h=1:f==null?g=void 0:f.length!==0?h=1:g=b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(e.action_link),function(a){return b("bs_block").__(0,[b("bs_block").__(0,[a,819537557,void 0])])});if(h===1)if(f==null)g=void 0;else{e=b("bs_belt_Array").keepMap(f.filter(function(a){return a.action_type!==12}),function(c){return b("bs_belt_Option").map(m(a,c),function(a){return{title:c.title,action:a}})});g=b("bs_block").__(1,[e])}h=c.media_blob_attachments;var i;if(h==null||h.length===0)i=void 0;else{f=h[0];e=f.__typename;if(e==null)i=void 0;else switch(e){case"Photo":h=f.large_preview;if(h==null)i=void 0;else{e=h.uri;i=e==null?void 0:b("bs_block").__(0,[e,{expand:!1}])}break;case"Video":h=f.id;e=f.height;var j=f.width;f=f.playable_url;i=h==null||e==null||j==null||f==null?void 0:b("bs_block").__(1,[f,h,{height:e,width:j,expand:!1}]);break;default:i=void 0}}return{preview:i!==void 0?i:b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.thumb_url),function(a){return b("bs_block").__(0,[a,{expand:!1}])}),title:b("bs_caml_option").nullable_to_opt(c.title),description:d,icon:void 0,action:g,canForward:i!==void 0,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function p(a,b){var c=b.items;if(c==null)return;else if(c.length!==0){c=c[0];return o(a,c)}else return o(a,b)}function q(a,b){var c=b.items;if(c==null)return;else if(c.length!==0){c=c[0];return o(a,c)}else return o(a,b)}function r(a,c){var d=c.media,e;if(d==null)e=void 0;else{d=d.image;e=d==null?void 0:b("bs_block").__(0,[d,{expand:!1}])}d=a.coordinate;var f=d==null?"":b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(d.latitude),"");d=a.coordinate;var g=d==null?"":b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(d.longitude),""),h=b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(c.title),"");d=a.is_expired;a=!(d==null)&&!d?b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.uri),function(a){return b("bs_block").__(0,[b("bs_block").__(4,[b("bs_block").__(4,[{titleString:h,uri:a,latitude:f,longitude:g}]),void 0])])}):void 0;return{preview:e,title:h,description:b("bs_caml_option").nullable_to_opt(c.description),icon:void 0,action:a,canForward:!1,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function s(a,c){if(b("gkx")("1251877")){a=c.subattachments;if(a==null||a.length===0)return;else{a=a[0];var d=a.target,e=a.media;if(d==null||e==null)return;else{d=d.video_id;var f=e.image_size;if(d==null||f==null)return;else{var g=f.height;f=f.width;if(g==null||f==null)return;else{var h=e.source;e=e.image;e=h==null?e==null?void 0:b("bs_block").__(0,[e,{expand:!0}]):b("bs_block").__(1,[h,d,{height:g,width:f,expand:!0}]);h=a.title;d=h==null||h===""?b("bs_caml_option").nullable_to_opt(c.description):h==null?void 0:b("bs_caml_option").some(h);g=a.uri;return{preview:e,title:d,description:b("bs_caml_option").nullable_to_opt(c.source),icon:void 0,action:g==null?(b("recoverableViolation")("Shared video is missing a url","messenger"),void 0):b("bs_block").__(0,[b("bs_block").__(0,[g,-10377365,void 0])]),canForward:!0,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}}}}}}function t(a,c){var d=c.items;d=d==null?"0":String(d.length);var e=c.total_cost;e=e==null?"":e;var f=c.payment_method;f=f==null?"":f;var i="",j="",k="",l=c.structured_address;if(!(l==null)){var m=l.city;i=m==null?"":m;m=l.country;m==null?"":m;m=l.postal_code;j=m==null?"":m;m=l.state;k=m==null?"":m}l=b("bs_string").concat(" ",[d,["items",[e,0]]]);m=h._("{receipt_subtitle}",[h._param("receipt_subtitle",l)]);d=f;e=i.length!==0?b("bs_string").concat("",[i,[", ",[k,[" ",[j,0]]]]]):void 0;l=b("bs_belt_Array").keepMap([m,d,e],function(a){return a}).join("\n");return{preview:void 0,title:h._("Order confirmation"),description:l,icon:b("bs_block").__(0,[{icon:b("fbicon")._(g("498146"),20),color:-910341463}]),action:b("bs_belt_Option").map(b("MWChatMessageId.bs").getMessageId(a),function(a){return b("bs_block").__(0,[b("bs_block").__(4,[b("bs_block").__(1,[{receiptId:b("bs_caml_option").nullable_to_opt(c.receipt_id),messageId:a}]),void 0])])}),canForward:!1,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function u(a){var c=a.pageID;c=c==null?"":c;var d=a.id,e=a.title;e=e==null?"":e;a=a.subtitle;a=a==null?"":a;return{preview:void 0,title:e,description:a,icon:void 0,action:b("bs_block").__(1,[[{title:h._("View Details"),action:b("bs_block").__(4,[b("bs_block").__(5,[{pageId:c,requestId:d}]),void 0])}]]),canForward:!1,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}var v=b("bs_block").__(0,[{icon:b("fbicon")._(g("571771"),20),color:322339018}]);function w(a){var b=a.arrival_airport.airport_code,c=a.arrival_time_info.formatted_time_for_display,d=a.departure_airport.airport_code;a=a.departure_time_info.formatted_time_for_display;d=h._("Departs {departure airport}{punctuation to separate airport and time}{departure time}",[h._param("departure airport",d),h._param("punctuation to separate airport and time"," \u2022 "),h._param("departure time",a)]);a=h._("Arrives {arrival airport}{punctuation to separate airport and time}{arrival time}",[h._param("arrival airport",b),h._param("punctuation to separate airport and time"," \u2022 "),h._param("arrival time",c)]);return[d,a]}function x(a){var c=a.flight_infos,d;if(c==null)d=["","",""];else{var e=c.length;if(e!==0){e=w(b("bs_caml_array").caml_array_get(c,0));d=[b("bs_caml_array").caml_array_get(c,0).flight_number,e[0],e[1]]}else d=["","",""]}c=h._("Time to check in for flight {flight number}",[h._param("flight number",d[0])]);return{preview:void 0,title:c,description:[d[1],d[2]].join("\n"),icon:v,action:b("bs_block").__(1,[[{title:b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(a.checkin_cta_label),""),action:b("bs_block").__(0,[b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(a.checkin_url),""),819537557,void 0])}]]),canForward:!0,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function y(a){var b=a.flight_info,c;if(b==null)c=["","","","","",""];else{var d=w(b);c=[b.flight_number,b.arrival_airport.airport_code,b.departure_airport.airport_code,b.departure_airport.gate,d[0],d[1]]}b=c[2];d=c[0];a=a.update_type;var e;if(a==null)e=[void 0,void 0,void 0];else switch(a){case"FLIGHT CANCELLATION":a=h._("Departs {departure airport}{punctuation to separate airport and flight cancellation}Cancelled",[h._param("departure airport",b),h._param("punctuation to separate airport and flight cancellation"," \u2022 ")]);var f=h._("Arrives {arrival airport}{punctuation to separate airport and flight cancellation}Cancelled",[h._param("arrival airport",c[1]),h._param("punctuation to separate airport and flight cancellation"," \u2022 ")]),g=h._("Flight {flight number} is cancelled",[h._param("flight number",d)]);e=[g,a,f];break;case"FLIGHT DELAY":g=h._("Flight {flight number} is delayed",[h._param("flight number",d)]);e=[g,c[4],c[5]];break;case"GATE CHANGE":a=h._("Departs {departure airport}{punctuation to separate airport and gate}Gate {gate}",[h._param("departure airport",b),h._param("punctuation to separate airport and gate"," \u2022 "),h._param("gate",c[3])]);e=[h._("Gate change for flight {flight number}",[h._param("flight number",d)]),a,void 0];break;default:e=[void 0,void 0,void 0]}return{preview:void 0,title:e[0],description:[e[1],e[2]].join("\n"),icon:v,action:void 0,canForward:!0,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function z(a){var c=a.boarding_passes,d;if(c==null)d=["","","","",void 0,[]];else{c=c.nodes;var e=c.length,f=b("bs_caml_array").caml_array_get(c,0).flight_info,g=w(f),i=g[1];g=g[0];d=e!==0?e!==1?[f.flight_number,g,i,h._("{passenger count} passengers",[h._param("passenger count",String(e))]),void 0,c]:[f.flight_number,g,i,b("bs_caml_array").caml_array_get(c,0).passenger.passenger.name,b("bs_caml_array").caml_array_get(c,0).qr_code_image_url,c]:["","","","",void 0,[]]}e=h._("Flight {flight number}",[h._param("flight number",d[0])]);return{preview:b("bs_belt_Option").map(d[4],function(a){return b("bs_block").__(0,[a,{expand:!0}])}),title:e,description:[d[1],d[2],d[3]].filter(function(a){return a!==""}).join("\n"),icon:v,action:b("bs_block").__(1,[[{title:b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(a.view_boarding_pass_cta_label),""),action:b("bs_block").__(4,[b("bs_block").__(3,[d[5]]),{pageId:"",ctaId:""}])}]]),canForward:!0,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function A(a){var b=a.aircraft_type_label;b=b==null?"":b;var c=a.arrival_time_label;c=c==null?"":c;var d=a.base_price_label;d=d==null?"":d;var e=a.booking_number_label;e=e==null?"":e;var f=a.departure_time_label;f=f==null?"":f;var g=a.flight_confirmation_label;g=g==null?"":g;var h=a.flight_date_label;h=h==null?"":h;var i=a.flight_label;i=i==null?"":i;var j=a.flight_terminal_label;j=j==null?"":j;var k=a.itinerary_error_title_label;k=k==null?"":k;var l=a.itinerary_title_label;l=l==null?"":l;var m=a.passenger_name_label;m=m==null?"":m;var n=a.passenger_names_label;n=n==null?"":n;var o=a.passenger_seat_label;o=o==null?"":o;var p=a.purchase_summary_label;p=p==null?"":p;var q=a.taxes_label;q=q==null?"":q;a=a.total_label;a=a==null?"":a;return{aircraftTypeLabel:b,arrivalTimeLabel:c,basePriceLabel:d,bookingNumberLabel:e,departureTimeLabel:f,flightConfirmationLabel:g,flightDateLabel:h,flightLabel:i,flightTerminalLabel:j,itineraryErrorTitleLabel:k,itineraryTitleLabel:l,passengerNameLabel:m,passengerNamesLabel:n,passengerSeatLabel:o,purchaseSummaryLabel:p,taxesLabel:q,totalLabel:a}}function B(a){var c=a.confirmation_number;c=c==null?"":c;var d=a.formatted_tax;d=d==null?"":d;var e=a.formatted_base_price;e=e==null?"":e;var f=a.formatted_total;f=f==null?"":f;var g=a.passenger_infos;g=g==null?0:g.length;var i=a.itemized_price_infos;i=i==null?[]:i;var j=a.itinerary_legs,k;if(j==null)k=[0,"",void 0];else{var l=j.nodes.length;if(l!==0){j=b("bs_caml_array").caml_array_get(j.nodes,0).segments.nodes;var m=A(a);e={confirmation_number:c,formatted_base_price:e,formatted_tax:d,formatted_total:f,itinerary_details:j,itemized_price_infos:i,labels:m};d=j.length;k=d!==0?[l,b("bs_caml_array").caml_array_get(j,0).flight_info.flight_number,b("bs_caml_option").some(e)]:[0,"",void 0]}else k=[0,"",void 0]}f=k[2];i=h._("Flight itinerary");m=h._("Booking {confirmation number}{punctuation to separate confimation number and flight number}{flight number}",[h._param("confirmation number",c),h._param("punctuation to separate confimation number and flight number"," \u2022 "),h._param("flight number",k[1])]);d=h._("{flight numbers} flights{punctuation to separate flight numbers and passenger numbers}{passenger numbers} passengers",[h._param("flight numbers",String(k[0])),h._param("punctuation to separate flight numbers and passenger numbers"," \u2022 "),h._param("passenger numbers",String(g))]);return{preview:void 0,title:i,description:b("bs_belt_Array").keepMap([m,d],function(a){return a}).join("\n"),icon:v,action:f!==void 0?b("bs_block").__(1,[[{title:b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(a.view_details_cta_label),""),action:b("bs_block").__(4,[b("bs_block").__(7,[b("bs_caml_option").valFromOption(f)]),{pageId:"",ctaId:""}])}]]):void 0,canForward:!0,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function C(a){a=a.requestMetadata;if(a==null)return;else return u(a)}function D(a,c){var d=b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(a.amountWithSymbol),"")+" ",e=b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(a.memoText),""),f=a.receiver;f=f==null?void 0:b("bs_caml_option").some(f.id);var i=a.status;i=i==null?void 0:b("bs_caml_option").some(i);if(b("bs_caml_option").some(b("CurrentUser").getID())===f&&i!==9){f=b("bs_block").__(1,[b("bs_belt_Array").keepMap([i===4?{title:h._("Receive Money"),action:b("bs_block").__(4,[b("bs_block").__(14,[{id:a.transfer_id,currentStatus:a.status}]),void 0])}:i===6?{title:h._("Verify Info"),action:b("bs_block").__(4,[b("bs_block").__(15,[{id:a.transfer_id,currentStatus:a.status}]),void 0])}:void 0,i===4||i===6?{title:h._("Decline"),action:b("bs_block").__(4,[b("bs_block").__(13,[{id:a.transfer_id,currentStatus:a.status}]),void 0])}:void 0],function(a){return a})]);i=f;i=i.tag&&i[0].length>0?f:void 0}else i=void 0;f=a.status;var j;if(f==null)j="";else switch(f){case 5:j=h._("Declined");break;case 13:j=h._("Complete");break;case 14:j=h._("Processing");break;case 3:case 10:case 11:case 12:case 16:case 19:j=h._("Cancelled");break;case 1:case 2:case 4:case 6:case 7:case 8:case 9:case 15:case 17:case 18:case 20:case 21:j=h._("Pending");break;default:j=""}f=a.status;var k;if(f==null)k=-999567389;else switch(f){case 3:case 5:case 10:case 11:case 12:case 13:case 14:case 16:case 19:k=-999567389;break;case 1:case 2:case 4:case 6:case 7:case 8:case 9:case 15:case 17:case 18:case 20:case 21:k=-944564459;break;default:k=-999567389}return{preview:void 0,title:e.length>0?h._("{amount_with_symbol} for {memo_text}",[h._param("amount_with_symbol",d),h._param("memo_text",e)]):h._("{amount_with_symbol}",[h._param("amount_with_symbol",d)]),description:j,icon:b("bs_block").__(0,[{icon:b("fbicon")._(g("847056"),20),color:k}]),action:i!==void 0?i:b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.uri),function(a){return b("bs_block").__(0,[b("bs_block").__(0,[a,819537557,void 0])])}),canForward:!1,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function E(a,c){var d=b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(a.amountWithSymbol),"")+" ",e=b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(a.memoText),""),f=a.requestee;f=f==null?void 0:b("bs_caml_option").some(f.id);f=b("bs_caml_option").nullable_to_opt(a.currentStatus)===1?b("bs_caml_option").some(b("CurrentUser").getID())===f?b("bs_block").__(1,[[{title:h._("Decline"),action:b("bs_block").__(4,[b("bs_block").__(12,[{id:a.id,currentStatus:a.currentStatus}]),void 0])},{title:h._("Pay"),action:b("bs_block").__(4,[b("bs_block").__(11,[{id:a.id,currentStatus:a.currentStatus}]),void 0])}]]):b("bs_block").__(1,[[{title:h._("Cancel"),action:b("bs_block").__(4,[b("bs_block").__(10,[{id:a.id,currentStatus:a.currentStatus}]),void 0])}]]):void 0;var i=a.currentStatus,j;if(i==null)j="";else switch(i){case 1:j=h._("Pending");break;case 2:j=h._("Declined");break;case 3:j=h._("Initiated");break;case 4:j=h._("Completed");break;case 5:j=h._("Failed");break;case 6:j=h._("Cancelled");break;case 7:j=h._("Expired");break;default:j=""}i=a.currentStatus;return{preview:void 0,title:e.length>0?h._("{amount_with_symbol} request for {memo_text}",[h._param("amount_with_symbol",d),h._param("memo_text",e)]):h._("{amount_with_symbol} request",[h._param("amount_with_symbol",d)]),description:j,icon:b("bs_block").__(0,[{icon:b("fbicon")._(g("847056"),20),color:i==null?-999567389:i>=3?i>=5?-999567389:-944564459:i!==1?-999567389:-944564459}]),action:f!==void 0?f:b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.uri),function(a){return b("bs_block").__(0,[b("bs_block").__(0,[a,819537557,void 0])])}),canForward:!1,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function c(a,c){var d=c.title;d=d==null||d===""?b("bs_caml_option").nullable_to_opt(c.description):d==null?void 0:b("bs_caml_option").some(d);return b("bs_block").__(1,[{preview:b("bs_belt_Option").flatMap(b("bs_caml_option").nullable_to_opt(c.media),function(a){a=a.image;if(a==null)return;else return b("bs_block").__(0,[a,{expand:!1}])}),title:d,description:b("bs_caml_option").nullable_to_opt(c.source),icon:void 0,action:b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.uri),function(a){return b("bs_block").__(0,[b("bs_block").__(0,[a,819537557,void 0])])}),canForward:!0,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]},void 0,a])}function d(a,c){var d=c.messenger_ctas,e,f=0;if(d==null||d.length!==1)f=1;else{d=d[0];e=b("bs_block").__(1,[[{title:d.action_title,action:b("bs_block").__(4,[b("bs_block").__(18,[{linkUrl:d.action_url}]),void 0])}]])}if(f===1){d=c.uri;e=d==null?void 0:b("bs_block").__(1,[[{title:"Try again",action:b("bs_block").__(0,[d,819537557,void 0])}]])}return b("bs_block").__(1,[{preview:b("bs_belt_Option").flatMap(b("bs_caml_option").nullable_to_opt(c.media),function(a){a=a.image;if(a==null)return;else return b("bs_block").__(0,[a,{expand:!1}])}),title:b("bs_caml_option").nullable_to_opt(c.title),description:b("bs_caml_option").nullable_to_opt(c.description),icon:b("MWXMA.bs").emptyContent.icon,action:e,canForward:b("MWXMA.bs").emptyContent.canForward,listItemsId:b("MWXMA.bs").emptyContent.listItemsId,listItemsDescriptionText:b("MWXMA.bs").emptyContent.listItemsDescriptionText,listItemsSecondaryDescriptionText:b("MWXMA.bs").emptyContent.listItemsSecondaryDescriptionText,listItems:b("MWXMA.bs").emptyContent.listItems},void 0,a])}function F(a){return{preview:void 0,title:b("bs_caml_option").nullable_to_opt(a.module_name),description:b("bs_caml_option").nullable_to_opt(a.curriculum_message),icon:void 0,action:void 0,canForward:!1,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function G(a){var c=h._("Would you like to keep going?"),d=a.mentorship_program,e;if(d==null)e="";else{d=d.other_member;if(d==null)e="";else{d=d.short_name;e=d==null?"":d}}d=h._("It's been a while since you and {partner_name} spoke. You can keep receiving programme guidance or, if you're ready, you can end the mentorship programme now.",[h._param("partner_name",e)]);e=h._("End Programme");var f=a.mentorship_program;f=f==null?void 0:b("bs_caml_option").some(f);return{preview:void 0,title:c,description:d,icon:void 0,action:f!==void 0?b("bs_block").__(1,[[{title:e,action:b("bs_block").__(4,[b("bs_block").__(8,[{programID:b("bs_caml_option").valFromOption(f).id,promptID:a.id}]),void 0])}]]):void 0,canForward:!1,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function H(a){var b=a.xma_type;return!(b==null)&&b==="MENTORSHIP_MESSENGER_LEAVE_PROMPT"?G(a):{preview:void 0,title:void 0,description:void 0,icon:void 0,action:void 0,canForward:!1,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:[]}}function e(a,b,c,d){if(d!==void 0)switch(d){case 0:return s(a,b);case 2:return p(d,a);case 3:return o(d,a);case 4:return t(c,a);case 5:return C(a);case 17:return y(a);case 18:return x(a);case 19:return z(a);case 20:return E(a,b);case 21:return D(a,b);case 22:return B(a);case 23:return n(a);case 24:return F(a);case 25:return H(a);case 26:return r(a,b);case 1:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 27:case 28:return q(d,a)}else return q(d,a)}f.parseXMATypeForAttachedStory=j;f.parseXMAType=a;f.convertCTAType=k;f.getGameUrl=l;f.parseXMAGenericCta=m;f.parseFbpayOffer=n;f.parseXMAGenericItem=o;f.parseBusinessGeneric=p;f.parseFirstXMAGenericItemFromTarget=q;f.parseLiveLocationShare=r;f.parseVideoShare=s;f.parseXMAReceipt=t;f.parseNativeBookingRequestMetadata=u;f.airlineIcon=v;f.getAirlineTemplateSubtitles=w;f.parseAirlineCheckIn=x;f.parseAirlineUpdate=y;f.parseAirlineBoardingPass=z;f.parseAirlineItineraryLabels=A;f.parseAirlineItinerary=B;f.parseNativeBookingRequest=C;f.parseP2pPaymentTransaction=D;f.parseP2pPaymentRequest=E;f.parseLinkShare=c;f.parseRoomsRingback=d;f.parseMentorshipCurriculumStep=F;f.parseMentorshipLeavePrompt=G;f.parseMentorshipXMA=H;f.parseSingleXMATarget=e}),null);
__d("MWMSParseMessage.bs",["FBID.bs","bs_array","bs_block","bs_curry","bs_js_exn","gkx","bs_js_dict","bs_caml_obj","bs_belt_Array","bs_caml_int64","LogHistory","MercuryIDs","bs_belt_Option","bs_caml_format","bs_caml_option","CurrentUser","GenderConst","MWChatMessage.bs","MWChatXmaMessage.bs","MercuryAudioType","MessengerMessage.bs","MercuryActionType","bs_caml_js_exceptions","recoverableViolation","MessengerParticipants.bs","MWChatMessageUnsendability.bs","RepliedToMessageStatusForGraphQL"],(function(a,b,c,d,e,f){"use strict";function g(a,c,d,e,f,g){var h=g.watermark;g=g.action;var i=a.name;c=b("bs_caml_obj").caml_lessequal(c.timestamp,h)||c.author===a.id&&b("bs_caml_obj").caml_notequal(c.action_type,b("MercuryActionType").LOG_MESSAGE)&&!d;if(e!==void 0){d=b("bs_caml_option").valFromOption(e);e=d.author===a.id||!b("bs_caml_obj").caml_greaterthan(d.timestamp,h)?!1:c}else e=c;d=a.big_image_src;if(!(d==null)&&e)return f.concat([{imageSrc:d,name:i,id:a.id,gender:a.gender,timestamp:g}]);else return f}function h(a,c,d,e,f,h){var i=b("bs_belt_Option").mapWithDefault(b("bs_caml_option").nullable_to_opt(h.last()),0,function(a){return a.watermark});i=d.timestamp<=i&&!d.is_one_way_sent;a=b("bs_js_dict").values(b("bs_belt_Option").getWithDefault(a,{})).reduce(function(a,f){return b("bs_belt_Option").mapWithDefault(b("bs_caml_option").nullable_to_opt(h.get(f.id)),a,function(b){return g(f,d,e,c,a,b)})},[]);var j=b("bs_caml_obj").caml_notequal(a,[]);if(j)return[a];else if(e&&i)return 0;else return b("MessengerMessage.bs").getGutterItemStatus(d,f)}function i(a,c){var d=b("MessengerParticipants.bs").getNow(a),e=function(a){if(d==null)return;else return d.short_name};a=b("MercuryIDs").getUserIDFromParticipantID(a);if(a==null)return e(0);else{c=b("bs_js_dict").get(c,a);if(c!==void 0)return c;else return e(0)}}function j(a){a=b("MessengerParticipants.bs").getNow(a);if(a==null)return b("GenderConst").UNKNOWN_SINGULAR;else return a.gender}function k(a){if(a==null)return!1;else return a.includes("message:save")}function l(a,c){a=a.reactions;if(a==null||Object.keys(a).length===0)return;else{var d={};b("bs_js_dict").entries(a).forEach(function(a){var e=a[1];a=b("FBID.bs").ofString(a[0]);a=a!==void 0?b("bs_caml_option").some(b("bs_caml_option").valFromOption(a)):void 0;if(a!==void 0){a=b("bs_caml_option").valFromOption(a);var f=b("bs_js_dict").get(d,e),g=i(b("MercuryIDs").getParticipantIDFromUserID(a),c);if(f!==void 0){f=f;f.push([a,g]);d[e]=f;return 0}else{d[e]=[[a,g]];return 0}}else return 0});return b("bs_caml_option").some(d)}}function m(a){var b=[];a==null||a.forEach(function(a){b.push({offset:a.offset,length:a.length,entity:{__typename:"Highlight"}});return 0});return b}function n(a){a=a.reactions;if(a==null)return;else return b("bs_js_dict").get(a,b("CurrentUser").getID())}function o(a,c,d){if(b("MWChatMessage.bs").isEmojiOnlyMessage(a))return{text:a,ranges:[],isForwarded:c.is_forwarded,isEmojiOnly:!0};else{d=b("MWChatMessage.bs").parseProfileRanges(d);var e=b("MWChatMessage.bs").findRanges(a),f=m(c.ranges),g=b("MWChatMessage.bs").employeeLinkRanges==null?[]:b("bs_curry")._1(b("MWChatMessage.bs").employeeLinkRanges.getURLRanges,a);return{text:a,ranges:b("bs_array").concat([d,[e,[f,[g,0]]]]),isForwarded:c.is_forwarded,isEmojiOnly:!1}}}function p(a){var c=a.preview_url;if(c==null){b("LogHistory").getInstance("messenger-comet").error("message-parse-photo-no-preview","");b("recoverableViolation")("message-parse-photo-no-preview","messenger_comet");return}else{var d=a.app_attribution;d=d==null?void 0:{id:d.id,iconUrl:b("bs_caml_option").nullable_to_opt(d.icon_url),name:d.name};var e=a.metadata;e=e==null?void 0:b("bs_caml_option").nullable_to_opt(e.fbid);var f=a.preview_height;f=f==null?void 0:f|0;var g=a.preview_width;g=g==null?void 0:g|0;var h=a.attach_type;h=h==="animated_image"?!0:!1;return b("bs_block").__(1,[{isGIF:h,previewUrl:c,previewHeight:f,previewWidth:g,appAttribution:d,photoFbid:e,blurredImageUri:b("bs_caml_option").nullable_to_opt(a.blurred_image_uri),decryptionKey:void 0}])}}function q(a){var c=a.preview_url,d=a.url,e=a.preview_height,f=a.preview_width,g=a.metadata;if(!(c==null)&&!(d==null)&&!(e==null)&&!(f==null)&&!(g==null)){return b("bs_block").__(6,[{height:e|0,width:f|0,previewUrl:c,fbid:(e=b("bs_caml_option")).nullable_to_opt(g.fbid),render_as_sticker:e.nullable_to_opt(g.render_as_sticker),dimensions:e.nullable_to_opt(g.dimensions),duration:e.nullable_to_opt(g.duration),large_size:e.nullable_to_opt(g.large_size),large_preview:e.nullable_to_opt(g.large_preview),inbox_size:e.nullable_to_opt(g.inbox_size),inbox_preview:e.nullable_to_opt(g.inbox_preview),url:d.toString(),decryptionKey:void 0}])}b("recoverableViolation")("Unsupported attachment type: "+a.attach_type,"messenger_comet");return}function r(a){var c=a.name;c=c==null?void 0:b("bs_caml_option").some(c);var d=a.url;if(d==null){b("recoverableViolation")("missing attachment.url","messenger_comet");return}else{a=a.metadata;if(a==null)return b("bs_block").__(3,[{fileName:c,url:d}]);else{var e=a.type;if(e==null)return b("bs_block").__(3,[{fileName:c,url:d}]);else if(e===b("MercuryAudioType").AudioClip||e===b("MercuryAudioType").FileAttachment||e===b("MercuryAudioType").VoiceMessageWithTranscript){c=a.duration;e=c==null?0:c/1e3;return b("bs_block").__(5,[{duration:e,url:d}])}else{b("recoverableViolation")("message-parse-file-unknown-type","messenger_comet");return}}}}function s(a,c){var d=a.media;d=d==null?void 0:b("bs_caml_option").nullable_to_opt(d.image);var e=a.uri;d=d!==void 0?b("bs_block").__(0,[d,{expand:!1}]):void 0;var f=b("bs_caml_option").nullable_to_opt(a.title);a=b("bs_caml_option").nullable_to_opt(a.description);e=e==null?void 0:b("bs_block").__(0,[b("bs_block").__(0,[e,819537557,void 0])]);var g=[];d={preview:d,title:f,description:a,icon:void 0,action:e,canForward:!1,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItems:g};return b("bs_block").__(7,[b("bs_block").__(1,[d,void 0,c])])}function t(a,c,d){var e,f=0;if(d!==void 0){var g=d;if(g!==1)g!==16?g>=28?e=b("MWChatXmaMessage.bs").parseLinkShare(c,a):f=1:b("gkx")("1462436")?e=b("MWChatXmaMessage.bs").parseRoomsRingback(c,a):f=1;else{g=a.subattachments;if(g==null)e=void 0;else{g=b("bs_belt_Array").keepMap(g,function(d){return b("bs_belt_Option").flatMap(b("bs_caml_option").nullable_to_opt(d.target),function(e){return b("MWChatXmaMessage.bs").parseSingleXMATarget(e,a,c,b("MWChatXmaMessage.bs").parseXMAType(d))})});e=b("bs_block").__(0,[g,void 0,c])}}}else f=1;f===1&&(e=b("bs_belt_Option").map(b("bs_belt_Option").flatMap(b("bs_caml_option").nullable_to_opt(a.target),function(e){return b("MWChatXmaMessage.bs").parseSingleXMATarget(e,a,c,d)}),function(a){return b("bs_block").__(1,[a,void 0,c])}));if(e!==void 0)return b("bs_block").__(7,[e])}function u(a,c){var d=a.attach_type;switch(d){case"file":return r(a);case"animated_image":case"photo":return p(a);case"share":d=a.share;if(d==null){b("LogHistory").getInstance("messenger-comet").error("message-parse-share-fail","");b("recoverableViolation")("message-parse-share-fail","messenger_comet");return}else{var e=b("MWChatXmaMessage.bs").parseXMAType(d);if(e===27)return s(d,c.messageID);else return t(d,c.messageID,e)}case"sticker":d=a.metadata;if(d==null){b("LogHistory").getInstance("messenger-comet").error("message-parse-sticker-no-metadata","");b("recoverableViolation")("message-parse-sticker-no-metadata","messenger_comet");return}else{c=a.url;e=d.accessibilityLabel;var f=d.frameCount,g=d.framesPerCol,h=d.framesPerRow;if(!(c==null)&&!(e==null)&&!(f==null)&&!(g==null)&&!(h==null)){return b("bs_block").__(0,[{accessibilityLabel:e,frameCount:f,frameRate:(e=b("bs_caml_option")).nullable_to_opt(d.frameRate),framesPerCol:g,framesPerRow:h,packID:e.nullable_to_opt(d.packID),paddedSpriteURI2x:e.nullable_to_opt(d.paddedSpriteURI2x),paddedSpriteURI:e.nullable_to_opt(d.paddedSpriteURI),spriteURI2x:e.nullable_to_opt(d.spriteURI2x),spriteURI:e.nullable_to_opt(d.spriteURI),stickerID:e.nullable_to_opt(d.stickerID),url:c.toString(),width:e.nullable_to_opt(d.width),height:e.nullable_to_opt(d.height)}])}b("LogHistory").getInstance("messenger-comet").error("message-parse-sticker-fail","");b("recoverableViolation")("message-parse-sticker-fail","messenger_comet");return}break;case"video":return q(a);default:b("recoverableViolation")("Unsupported attachment type: "+a.attach_type,"messenger_comet");b("LogHistory").getInstance("messenger-comet").error("message-parse-attachment-unsupported","");return}}function v(a){a=a.reduce(function(a,b){if(a!==void 0){b=p(b);if(b!==void 0){b=b;if(b.tag===1)return a.concat([b[0]]);else return}else return}},[]);if(a!==void 0)return b("bs_block").__(2,[a])}function w(a){a=a.reduce(function(a,c){if(a!==void 0){c=r(c);if(c!==void 0){c=c;if(c.tag===3)return a.concat([c[0]]);else{b("recoverableViolation")("Received non-File content from parseFile","messenger_comet");return}}else return}},[]);if(a!==void 0)return b("bs_block").__(4,[a])}function x(a,c,d){if(a==null){b("LogHistory").getInstance("messenger-comet").error("message-parse-no-attachment-given","");b("recoverableViolation")("message-parse-no-attachment-given","messenger_comet");return}else{var e=a.length;if(e!==1)if(e!==0){e=a[0];if(e.attach_type==="photo")return v(a);else return w(a)}else{e=c.preview_attachments;if(e==null)return;else{c=e.length;if(c!==1)if(c!==0)return v(e);else return;else{c=e[0];if(c.preview_url==null)return r(c);else return p(c)}}}else{e=a[0];return u(e,d)}}}function a(a){a=a.platform_xmd;if(a==null)return;else{a=JSON.parse(a);return b("bs_caml_option").nullable_to_opt(a.persona)}}function y(a,c){var d=a.profile_ranges;d=d==null?[]:d;var e=a.body,f=a.has_attachment,g;if(e==null)g=f==null||!f?2:1;else if(f==null||!f)return b("bs_block").__(0,[o(e,a,d)]);else if(e==="")g=1;else{f=x(a.attachments,a,c);if(f!==void 0){e=o(e,a,d);return b("bs_block").__(1,[f,e])}else return}switch(g){case 1:d=x(a.attachments,a,c);if(d!==void 0)return b("bs_block").__(1,[d,void 0]);else return;case 2:b("LogHistory").getInstance("messenger-comet").error("message-parse-no-body-or-attachment","");b("recoverableViolation")("message-parse-no-body-or-attachment","messenger_comet");return}}function z(a){var c=a.body;c=!(c==null)&&c!==""?c:void 0;var d=a.has_attachment;d=d==null?!1:d;if(c!==void 0){c=c;var e=a.profile_ranges;e=e==null?[]:b("MWChatMessage.bs").parseProfileRanges(e);var f=b("MWChatMessage.bs").findRanges(c);return b("bs_block").__(0,[{ranges:b("bs_array").concat([e,[f,0]]),text:c,messageID:a.message_id}])}else if(d){e=a.attachments;if(e==null){b("LogHistory").getInstance("messenger-comet").error("replied-message-parse-no-attachment-given","");b("recoverableViolation")("replied-message-parse-no-attachment-given","messenger_comet");return}else{f=e.length;if(f!==1)if(f!==0){var g=[];e.forEach(function(a){a=a.preview_url;if(a==null)return 0;else{g.push(a);return 0}});return b("bs_block").__(3,[{attachments:g,messageID:a.message_id}])}else{c=a.preview_attachments;if(c==null||c.length!==1){b("recoverableViolation")("replied-message-parse-expected-preview_attachments","messenger_comet");return}else{d=c[0];f=d.preview_url;if(f==null){b("LogHistory").getInstance("messenger-comet").error("replied-message-parse-photo-no-preview","");b("recoverableViolation")("replied-message-parse-photo-no-preview","messenger_comet");return}else return b("bs_block").__(2,[{previewUrl:f,messageID:a.message_id}])}}else{c=e[0];d=c.attach_type;switch(d){case"photo":f=c.preview_url;if(f==null){b("LogHistory").getInstance("messenger-comet").error("replied-message-parse-photo-no-preview","");b("recoverableViolation")("replied-message-parse-photo-no-preview","messenger_comet");return}else return b("bs_block").__(2,[{previewUrl:f,messageID:a.message_id}]);case"sticker":e=c.metadata;if(e==null){b("LogHistory").getInstance("messenger-comet").error("replied-message-parse-sticker-no-metadata","");b("recoverableViolation")("replied-message-parse-sticker-no-metadata","messenger_comet");return}else{d=c.url;f=e.accessibilityLabel;c=e.frameCount;var h=e.framesPerCol,i=e.framesPerRow;if(!(d==null)&&!(f==null)&&!(c==null)&&!(h==null)&&!(i==null)){return b("bs_block").__(1,[{sticker:{accessibilityLabel:f,frameCount:c,frameRate:(f=b("bs_caml_option")).nullable_to_opt(e.frameRate),framesPerCol:h,framesPerRow:i,packID:f.nullable_to_opt(e.packID),paddedSpriteURI2x:f.nullable_to_opt(e.paddedSpriteURI2x),paddedSpriteURI:f.nullable_to_opt(e.paddedSpriteURI),spriteURI2x:f.nullable_to_opt(e.spriteURI2x),spriteURI:f.nullable_to_opt(e.spriteURI),stickerID:f.nullable_to_opt(e.stickerID),url:d.toString(),width:f.nullable_to_opt(e.width),height:f.nullable_to_opt(e.height)},messageID:a.message_id}])}b("LogHistory").getInstance("messenger-comet").error("replied-message-parse-sticker-fail","");b("recoverableViolation")("replied-message-parse-sticker-fail","messenger_comet");return}break;default:return b("bs_block").__(4,[{messageID:a.message_id}])}}}}else{b("LogHistory").getInstance("messenger-comet").error("replied-message-parse-no-body-or-attachment","");b("recoverableViolation")("replied-message-parse-no-body-or-attachment","messenger_comet");return}}function A(a,c){c=b("bs_caml_format").caml_int64_of_string(b("MercuryIDs").getThreadFBIDFromThreadID(c.thread_id));if(b("MessengerMessage.bs").isSent(a))return b("bs_block").__(1,[{threadId:c,messageId:a.message_id,timestamp:b("bs_caml_int64").of_float(a.timestamp)}]);else{a=a.offline_threading_id;if(a==null){b("recoverableViolation")("Optimistic message without offline threading id","messenger_web_product");return 0}else return b("bs_block").__(0,[{threadId:c,offlineThreadingId:a}])}}function B(a,c,d,e,f,g,m,o,p,q){var r=b("MWChatMessageUnsendability.bs").canUnsend(f,c),s=j(a);p=h(b("bs_caml_option").some(p),d,f,m,g,o);d=l(f,q);g=k(f.tags);o=n(f);m=m?void 0:i(a,q);q=A(f,c);c=f.timestamp;q={messageID:q,isSaved:g,author:a,authorGender:s,status:p,timestamp:c,canRemoveGlobally:r};g=f.removed_timestamp;if(g==null){s=y(f,q);p=s!==void 0?b("bs_block").__(0,[q,{reactions:d,selectedReaction:o},s]):b("bs_block").__(2,[q])}else p=b("bs_block").__(1,[q,{removedTimestamp:g,authorName:m}]);c=f.replied_to_message;if(c==null)return b("bs_block").__(0,[p]);else{r=c.message;d=c.status;if(r==null)if(b("bs_caml_obj").caml_equal(d,b("RepliedToMessageStatusForGraphQL").DELETED)){o=a.replace("fbid:","").replace("user:","")===e.replace("fbid:","").replace("user:","");if(o)return b("bs_block").__(2,[0,p]);else return b("bs_block").__(1,[0,p])}else return b("bs_block").__(0,[p]);else{s=r.author;if(s==null){g=z(r);if(g!==void 0)return b("bs_block").__(1,[g,p]);else return b("bs_block").__(0,[b("bs_block").__(2,[q])])}else{m=z(r);if(m!==void 0){f=m;if(s.includes(e))return b("bs_block").__(2,[f,p]);else return b("bs_block").__(1,[f,p])}else return b("bs_block").__(0,[b("bs_block").__(2,[q])])}}}}function c(a,c,d,e,f,g,h,i,j,k){try{return B(a,c,d,e,f,g,h,i,j,k)}catch(e){d=b("bs_caml_js_exceptions").internalToOCamlException(e);if(d[0]===b("bs_js_exn").$$Error){b("recoverableViolation")("Error thrown when parsing message","messenger_comet");b("LogHistory").getInstance("messenger-comet").error("Error thrown when parsing message:",b("bs_belt_Option").getWithDefault(d[1].message,""));return b("bs_block").__(0,[b("bs_block").__(2,[{messageID:A(f,c),isSaved:!1,author:a,authorGender:b("GenderConst").NOT_A_PERSON,status:0,timestamp:f.timestamp,canRemoveGlobally:!1}])])}else throw d}}f.concatLatestMessageHeads=g;f.getGutterItemStatus=h;f.getAuthorName=i;f.getAuthorGender=j;f.parseSaved=k;f.parseReactions=l;f.parseHighlightRanges=m;f.selectedReaction=n;f.parseBody=o;f.parsePhoto=p;f.parseVideo=q;f.parseFile=r;f.parseFallbackXMA=s;f.parseXMA=t;f.parseAttachment=u;f.parsePhotoGroup=v;f.parseFileGroup=w;f.parseAttachments=x;f.getPersona=a;f.parseMessageData=y;f.parseRepliedMessageData=z;f.getMessageID=A;f.tryParse=B;f.parse=c}),null);
__d("MWMSReadReceipts.bs",["React","CurrentUser","MWChatThreadId.bs","MessengerState.bs","MessengerReadReceipt.bs"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function h(a,c){c=b("MWChatThreadId.bs").getMercuryID(c);return b("MessengerReadReceipt.bs").getSeenTimestamps(a,c)}function a(a){var c=b("MessengerState.bs").useHook(b("CurrentUser").getID()),d=c.readReceiptsPerThread;return g.useMemo(function(){return h(d,a)},[d,a])}f.get=h;f.useHook=a}),null);
__d("MWMSRepliedToMessage.bs",["FBID.bs","bs_curry","React","bs_belt_Map","MWThread.bs","bs_belt_Option","bs_caml_option","CurrentUser","MWChatThreadId.bs","MessengerState.bs","MWChatMessageId.bs","MWMSParseMessage.bs","MWMSReadReceipts.bs","MWUILoadParticipants.bs","MWMSDeliveryTimestamp.bs"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function a(a){a=g.useState(function(){return});var c=a[1],d=b("MWThread.bs").useIdExn(0),e=b("MessengerState.bs").useHook(b("CurrentUser").getID()),f=b("bs_belt_Map").get(e.threads,b("MWChatThreadId.bs").getMercuryID(d));e=b("bs_curry")._1(b("MWUILoadParticipants.bs").useMercuryParticipants,d);var h=e[1],i=e[0],j=b("MWMSDeliveryTimestamp.bs").useHook(d),k=b("MWMSReadReceipts.bs").useHook(d),l=b("MessengerState.bs").getCurrentlyLoadedMessages(b("CurrentUser").getID(),b("MWChatThreadId.bs").getMercuryID(d));e=function(a){var d=b("bs_belt_Option").flatMap(b("MWChatMessageId.bs").getMessageId(a),function(a){var c=a;a=l;var d=f,e=i,g=j,m=k,n=h;a=a.find(function(a){return a.message_id===c});if(a!==void 0){var o=a.author;if(o==null||d===void 0)return;else{var p=b("CurrentUser").getID(),q=o.replace("fbid:","").replace("user:",""),r=q===p.replace("fbid:","").replace("user:","");o=b("MWMSParseMessage.bs").parse(o,b("bs_caml_option").valFromOption(d),void 0,p,a,g,r,m,e,n);var s;switch(o.tag|0){case 0:s=o[0];break;case 1:case 2:s=o[1];break}return{content:s,fromViewer:r,authorID:b("FBID.bs").ofStringExn(q)}}}});return b("bs_curry")._1(c,function(a){return d})};d=function(a){return b("bs_curry")._1(c,function(a){return})};return[a[0],e,d]}f.useCurrentlyRepliedToMessage=a}),null);
__d("MWMSSendXMDMessage.bs",["Promise","bs_curry","bs_js_dict","bs_belt_Option","bs_caml_option","CurrentUser","FBMqttChannel","MessengerState.bs","getCurrentRoute","MercuryActionType","MercurySourceType","MWMSLogMessageSend.bs","MercuryActionStatus","useCometRouterState","MWChatTabEntryPoints.bs","MWMSOptimisticUpdate.bs","MessengerStatePrinter.bs","MessengerWebEntryPoint","unrecoverableViolation","MWUIPresenceIsThreadActive.bs"],(function(a,b,c,d,e,f){"use strict";function a(a){var c=b("useCometRouterState")(),d=b("bs_curry")._1(b("MWUIPresenceIsThreadActive.bs").useHook,0);return function(a,e,f){var g=b("CurrentUser").getID(),h=c==null?null:b("getCurrentRoute")(c).tracePolicy,i=f!==void 0?b("MessengerState.bs").getServerMessageID(b("CurrentUser").getID(),b("bs_caml_option").valFromOption(f).message_id):void 0;if(a[0]>=757211935){var j=a[1],k=b("bs_belt_Option").getWithDefault(b("bs_js_dict").get(b("MWChatTabEntryPoints.bs").tabEntryPoints,j),b("MessengerWebEntryPoint").UNKNOWN),l=e.body;e=b("MWMSOptimisticUpdate.bs").make(g,l,a,void 0,e,void 0,f,void 0);f=e.offline_threading_id;l=b("MessengerStatePrinter.bs").jsonPrettyStringify({body:l,sender_fbid:g,to:j,msgid:f,generic_metadata:{platform_xmd:e.platform_xmd},client_tags:{web_source:b("MercurySourceType").CHAT_WEB,"web:trigger":k,tracePolicy:h},repliedToMessageId:i});var m=b("bs_caml_option").some(e);b("MWMSLogMessageSend.bs").log(f,a,{tracePolicy:h,isActiveNow:d});b("FBMqttChannel").publish("/send_message2",l).then(function(a){return b("Promise").resolve(0)})["catch"](function(a){a=Object.assign(b("bs_caml_option").valFromOption(m),{status:b("MercuryActionStatus").ERROR,action_type:b("MercuryActionType").SEND_MESSAGE,error_data:{type:3,is_transient:!0}});b("MessengerState.bs").sendJS(g,b("MessengerState.bs").processJSActions(a));return b("Promise").resolve(0)});return 0}else return b("unrecoverableViolation")("Not supported","messenger_web_product")}}f.useSendXMDMessage=a}),null);
__d("MWChatSolidReactionSettingDefault",[],(function(a,b,c,d,e,f){"use strict";function a(){return!1}e.exports={useIsSolid:a}}),null);